---
/* const { name, count, topThreeTags, image } = Astro.props; */
import Layout2025 from '../layouts/Layout2025.astro';
import AddBookForm from '../components/dashboard/AddBookForm.astro';
import { Image } from 'astro:assets';
import image from '../assets/images/books.svg';
import { getCollection } from 'astro:content';
import CardConcorrente from 'astro/components/dashboard/CardConcorrente.astro';
import Header2025 from 'astro/components/dashboard/Header2025.vue';

const concorrenti = await getCollection('concorrenti25');

// Function to determine color based on points (customize as needed)
function getColor(points: number) {
  if (points > 100) return 'bg-red-500';
  if (points > 75) return 'bg-orange-500';
  if (points > 50) return 'bg-yellow-500';
  return 'bg-green-500';
}
---

<Layout2025>
  <div class='min-h-screen flex bg-basque-40'>
    <!-- Responsive Sidebar: Adjust width on smaller screens -->
    <div
      class='hidden sm:hidden md:block lg:block w-64 bg-basque-20 text-gray-100 flex-col justify-between'>
      <div class='p-6'>
        <h1 class='text-2xl font-bold text-basque-10 tracking-wide'>
          Liburu Lehiaket
        </h1>
        <nav class='mt-8 space-y-4'>
          <a
            href='#'
            class='block py-2 px-4 rounded-lg bg-gray-800 hover:bg-basque-30 transition-all text-sm font-semibold'>
            Overview
          </a>
          <a
            href='#'
            class='block py-2 px-4 rounded-lg hover:bg-basque-30 transition-all text-sm font-semibold'>
            Concorrenti
          </a>
          <a
            href='/'
            class='block py-2 px-4 rounded-lg hover:bg-basque-30 transition-all text-sm font-semibold'>
            Classifica
          </a>
        </nav>
      </div>
      <div class='p-6 hidden md:block'>
        <AddBookForm />
      </div>
    </div>

    <!-- Main Content Area -->
    <div class='flex-1 p-6 overflow-y-auto bg-black'>
      <Header2025 client:load />

      <!-- Header with Responsive Flexbox -->
      <header
        class='bg-basque-30 shadow-xl rounded-lg p-4 sm:p-6 flex items-center justify-between'>
        <Image
          src={image}
          alt='Profile Picture'
          class='rounded-full'
          width='56'
          height='56'
          format='webp'
        />
        <h2 class='text-2xl sm:text-3xl font-semi text-gray-800'>
          Lehiakidearen Irakurketa Aurrerapena
        </h2>
      </header>

      <!-- Concorrente Details with Responsive Grid -->
      <main class='mt-6'>
        <div class='bg-gray-50 rounded-lg shadow-lg p-6'>
          <h3 class='text-2xl font-semibold mb-4 text-gray-800'>
            Lehiakidearen Informazioa
          </h3>

          <!-- Responsive Grid for Concorrente Info -->
          <div class='grid grid-cols-1 gap-4 p-4'>
            {
              concorrenti.map(concorrente => (
                <CardConcorrente
                  concorrente={concorrente.data}
                  key={concorrente.id}
                />
              ))
            }
          </div>
          <div
            class='grid grid-cols-1 md:grid-cols-2 gap-6 border-2 border-basque-50'>
            <div
              class='bg-gradient-to-tr from-green-100 to-green-200 p-6 rounded-lg shadow-md text-center hover:scale-105 transition-transform'>
              <h4 class='text-gray-700 text-xl font-medium'>
                Irakurritako Liburuak
              </h4>
              <p class='text-3xl font-bold text-basque-20 mt-2'>55</p>
            </div>
            <div
              class='bg-gradient-to-tr from-pink-100 to-pink-200 p-4 sm:p-6 rounded-lg shadow-md md:col-span-2 hover:scale-105 transition-transform'>
              <h4 class='text-gray-700 text-lg sm:text-xl font-medium'>
                Genero Kuttunak
              </h4>
              <ul
                class='flex justify-center space-x-2 sm:space-x-4 mt-2 sm:mt-4'>
                top 3
                <!--  {
                topThreeTags.map((tag: string) => (
                  <li class='bg-pink-300 text-pink-900 px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm'>
                    {tag}
                  </li>
                ))
              } -->
              </ul>
            </div>
            <div class='p-6 sm:block md:hidden'>
              <AddBookForm />
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>
</Layout2025>
<style>
  @keyframes growWidth {
    from {
      width: 0;
    }
    to {
      width: var(--target-width); /* Using CSS variable for dynamic width */
    }
  }

  .progress-bar {
    background-color: #4caf50; /* Use dynamic color via class or style */
    height: 100%;
    border-radius: 5px;
    animation: growWidth 2s ease-out forwards; /* Ensure animation fills the bar to the target width */
  }
</style>
